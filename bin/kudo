#!/usr/bin/env babel-node

let minimist = require('minimist');

import {deduce} from '../lib/cli';

/**
 * 显示 package.json 中的版本号
 */
function displayVersion() {
    let pkg = require('../package');
    console.log('%s %s', pkg.name, pkg.version);
}

/**
 * 命令入口
 *
 * @param {?Array} argv 命令行参数
 */
function run(argv) {
    let options = minimist(
        argv || [],
        {
            'string': ['_', 'since'],
            'default': {
                since: '3.months.ago'
            },
            'alias': {
                v: 'version'
            }
        }
    );

    if (options.version) {
        return displayVersion();
    }

    let [name, since] = options._;
    since = since || options.since;

    if (!name) {
        console.log('USAGE:');
        console.log('\tscout <author> [--since=\'3.months.ago\']');
        return;
    }

    deduce(name, since);
}

run(process.argv.slice(2));

